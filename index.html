<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Clickatellbundle by archer-soft</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Clickatellbundle</h1>
          <h2></h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/archer-soft/ClickatellBundle/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/archer-soft/ClickatellBundle/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/archer-soft/ClickatellBundle" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>Getting Started With ClickatellBundle</h1>

<p><a href="http://www.clickatell.com/">Clickatell</a></p>

<h2>Prerequisites</h2>

<p>This version of the bundle requires Symfony 2.1+</p>

<h3>Translations</h3>

<p>If you wish to use default texts provided in this bundle, you have to make
sure you have translator enabled in your config.</p>

<div class="highlight"><pre><span class="c1"># app/config/config.yml</span>

<span class="l-Scalar-Plain">framework</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">translator</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</pre></div>

<p>For more information about translations, check <a href="http://symfony.com/doc/current/book/translation.html">Symfony documentation</a>.</p>

<h2>Installation</h2>

<p>Installation is a quick 5 step process:</p>

<ol>
<li>Download ArcherClickatellBundle using composer</li>
<li>Enable the Bundle</li>
<li>Create your Message class</li>
<li>Configure the ArcherClickatellBundle</li>
<li>Update your database schema</li>
</ol><h3>Step 1: Download ArcherClickatellBundle using composer</h3>

<p>Add ArcherClickatellBundle in your composer.json:</p>

<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">"require"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"archer/clickatell-bundle"</span><span class="o">:</span> <span class="s2">"dev-master"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Now tell composer to download the bundle by running the command:</p>

<div class="highlight"><pre><span class="nv">$ </span>php composer.phar update archer/clickatell-bundle
</pre></div>

<p>Composer will install the bundle to your project's <code>vendor/archer</code> directory.</p>

<h3>Step 2: Enable the bundle</h3>

<p>Enable the bundle in the kernel:</p>

<div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1">// app/AppKernel.php</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">registerBundles</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$bundles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// ...</span>
        <span class="k">new</span> <span class="nx">Archer\ClickatellBundle\ArcherClickatellBundle</span><span class="p">(),</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>

<h3>Step 3: Create your Message class</h3>

<p>The goal of this bundle is to persist some <code>Message</code> class to a database (MySql,
MongoDB, CouchDB, etc).</p>

<p>The bundle provides base classes which are already mapped for most fields
to make it easier to create your entity. Here is how you use it:</p>

<ol>
<li>Extend the base <code>Message</code> class (the class to use depends of your storage)</li>
<li>Map the <code>id</code> field. It must be protected as it is inherited from the parent class.</li>
</ol><p><strong>Note:</strong></p>

<blockquote>
<p>The doc uses a bundle named <code>AcmeMessageBundle</code>. If you want to use the same
name, you need to register it in your kernel. But you can of course place
your Message class in the bundle you want.</p>
</blockquote>

<p><strong>Warning:</strong></p>

<blockquote>
<p>If you override the <strong>construct() method in your Message class, be sure
to call parent::</strong>construct(), as the base Message class depends on
this to initialize some fields.</p>
</blockquote>

<p><strong>a) Doctrine ORM Message class</strong></p>

<p>If you're persisting your message via the Doctrine ORM, then your <code>message</code> class
should live in the <code>Entity</code> namespace of your bundle and look like this to
start:</p>

<div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1">// src/Acme/MessageBundle/Entity/Message.php</span>

<span class="k">namespace</span> <span class="nx">Acme\MessageBundle\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Archer\ClickatellBundle\Entity\Message</span> <span class="k">as</span> <span class="nx">BaseMessage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Doctrine\ORM\Mapping</span> <span class="k">as</span> <span class="nx">ORM</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * @ORM\Entity</span>
<span class="sd"> * @ORM\Table(name="clickatell_message")</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">Message</span> <span class="k">extends</span> <span class="nx">BaseMessage</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @ORM\Id</span>
<span class="sd">     * @ORM\Column(type="integer")</span>
<span class="sd">     * @ORM\GeneratedValue(strategy="AUTO")</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$id</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
        <span class="c1">// your own logic</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><strong>b) MongoDB Message class</strong>
<strong>c) CouchDB Message class</strong>
<strong>d) Propel Message class</strong></p>

<h3>Step 4: Configure the ArcherClickatell</h3>

<p>Add the following configuration to your <code>config.yml</code> file according to which type
of datastore you are using.</p>

<div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">archer_clickatell</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span>                 <span class="l-Scalar-Plain">~</span> <span class="c1"># your username for clickatell</span>
    <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>             <span class="l-Scalar-Plain">~</span> <span class="c1"># your password for clickatell</span>
    <span class="l-Scalar-Plain">api_id</span><span class="p-Indicator">:</span>               <span class="l-Scalar-Plain">~</span> <span class="c1"># your id for clickatell</span>
    <span class="l-Scalar-Plain">message_class</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">Acme\MessageBundle\Entity\Message</span>
</pre></div>

<div class="highlight"><pre># app/config/config.xml
<span class="c">&lt;!-- app/config/config.xml --&gt;</span>

<span class="nt">&lt;archer_clickatell:config</span>
    <span class="na">user=</span><span class="s">"username"</span>
    <span class="na">password=</span><span class="s">"password"</span>
    <span class="na">api-id=</span><span class="s">"api_id"</span>
    <span class="na">message-class=</span><span class="s">"Acme\MessageBundle\Entity\Message"</span>
<span class="nt">/&gt;</span>
</pre></div>

<h3>Step 5: Update your database schema</h3>

<p>Now that the bundle is configured, the last thing you need to do is update your
database schema because you have added a new entity, the <code>Message</code> class which you
created in Step 4.</p>

<p>For ORM run the following command.</p>

<div class="highlight"><pre><span class="nv">$ </span>php app/console doctrine:schema:update --force
</pre></div>

<h3>Usage Steps</h3>

<div class="highlight"><pre><span class="c1">//send  Sms</span>
<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'clickatell.send_message.form'</span><span class="p">);</span>
<span class="nv">$form</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">());</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">())</span> <span class="p">{</span>
    <span class="nv">$message</span> <span class="o">=</span> <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">();</span>
    <span class="nv">$clickatell</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'clickatell.http'</span><span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$clickatell</span><span class="o">-&gt;</span><span class="na">sendMessage</span><span class="p">(</span><span class="nv">$message</span><span class="o">-&gt;</span><span class="na">getToPhone</span><span class="p">(),</span> <span class="nv">$message</span><span class="o">-&gt;</span><span class="na">getText</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
        </section>

        <footer>
          Clickatellbundle is maintained by <a href="https://github.com/archer-soft">archer-soft</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>